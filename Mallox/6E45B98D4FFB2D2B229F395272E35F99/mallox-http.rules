alert http any any -> any any (msg:"Mallox Suspicious HTTP Response IP Lookup"; flow:from_server,established; http.stat_code; content:"200"; http.stat_msg; content:"OK"; http.response_body; pcre:"/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/"; http.header_names; content:"Vary"; reference:md5,6E45B98D4FFB2D2B229F395272E35F99; classtype:trojan-activity; sid:1110012; rev:1; metadata:malware_family Mallox Ransomeware;)

alert http any any -> any any (msg:"Mallox CnC Beacon Checkin"; flow:to_server,established; http.method; content:"POST"; http.uri; content:".php"; endswith; http.request_body; content:"TargetID="; nocase; fast_pattern; content:"user="; content:"SystemInformation"; content:"max_size_of_file="; content:"size_of_hdd="; flowbits:set,Mallox-CnC-Checkin; reference:md5,6E45B98D4FFB2D2B229F395272E35F99; classtype:trojan-activity; sid:1110013; rev:1; metadata:malware_family Mallox Ransomeware;)

alert http any any -> any any (msg:"Mallox CnC Beacon Target Added"; flow:from_server,established; flowbits:isset,Mallox-CnC-Checkin; http.response_body; content:"Successfully_added"; nocase; fast_pattern; reference:md5,6E45B98D4FFB2D2B229F395272E35F99; classtype:trojan-activity; sid:1110014; rev:1; metadata:malware_family Mallox Ransomeware;)